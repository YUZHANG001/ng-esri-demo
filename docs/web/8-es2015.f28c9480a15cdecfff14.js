(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{RXpd:function(e,t,n){"use strict";n.r(t),n.d(t,"SceneEditorModule",(function(){return p}));var i=n("2kYt"),o=n("NcZ/"),s=n("sEIs"),r=n("D57K"),c=n("69HR"),a=n("EM62"),d=n("1i8C");const l=["editorEl"],b=[{path:"",component:(()=>{class e{constructor(e){this.map=e}ngOnInit(){this.messageEventHandler=this.receiveMessage.bind(this),addEventListener("message",this.messageEventHandler,!1)}ngOnDestroy(){removeEventListener("message",this.messageEventHandler)}loadWebSceneToEditor(){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield this.map.loadWebSceneProperties();this.editorEl.nativeElement.contentWindow.postMessage({language:"json",value:JSON.stringify(e,null,"  ")},"*")}))}updateWebScene(){return Object(r.a)(this,void 0,void 0,(function*(){const e=yield this.map.loadWebSceneProperties();this.map.sceneView.subscribe(t=>{e.initialViewProperties.viewingMode=t.viewingMode,e.initialViewProperties.viewpoint=t.viewpoint,this.loadWebSceneToEditor()})}))}updateSceneView(){this.editorEl.nativeElement.contentWindow.postMessage("getValue","*")}cloneWebScene(){const e=JSON.stringify(this.webscene);return JSON.parse(e)}receiveMessage(e){this.editorEl.nativeElement.src.startsWith(e.origin)&&this.map.sceneView.subscribe(t=>Object(r.a)(this,void 0,void 0,(function*(){try{const n=JSON.parse(e.data);this.webscene=n;const i=this.cloneWebScene(),o=yield c.e(i);t.map=o}catch(n){alert("\u914d\u7f6e\u9519\u8bef\uff01"),console.error(n)}})))}}return e.\u0275fac=function(t){return new(t||e)(a.Qb(d.a))},e.\u0275cmp=a.Kb({type:e,selectors:[["app-scene-editor-home"]],viewQuery:function(e,t){var n;1&e&&a.yc(l,!0),2&e&&a.sc(n=a.ic())&&(t.editorEl=n.first)},decls:12,vars:0,consts:[["href","https://developers.arcgis.com/javascript/latest/api-reference/","target","_blank",1,"m-1","text-muted"],[1,"fas","fa-info-circle"],["src","https://beginor.github.io/monaco-editor/index.html",1,"code-editor","border","border-secondary","m-1",3,"load"],["editorEl",""],[1,"tools","btn-group","btn-group-sm","m-1"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fa","fa-fw","fa-angle-double-left"],[1,"fa","fa-fw","fa-angle-double-right"]],template:function(e,t){1&e&&(a.Vb(0,"a",0),a.Rb(1,"i",1),a.Cc(2," ArcGIS JS API Reference"),a.Ub(),a.Vb(3,"iframe",2,3),a.hc("load",(function(){return t.loadWebSceneToEditor()})),a.Ub(),a.Vb(5,"div",4),a.Vb(6,"button",5),a.hc("click",(function(){return t.updateWebScene()})),a.Rb(7,"i",6),a.Cc(8," \u66f4\u65b0\u914d\u7f6e "),a.Ub(),a.Vb(9,"button",5),a.hc("click",(function(){return t.updateSceneView()})),a.Rb(10,"i",7),a.Cc(11," \u66f4\u65b0\u5730\u56fe "),a.Ub(),a.Ub())},styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .code-editor[_ngcontent-%COMP%]{flex:1}"]}),e})()}];let u=(()=>{class e{}return e.\u0275mod=a.Ob({type:e}),e.\u0275inj=a.Nb({factory:function(t){return new(t||e)},imports:[[s.c.forChild(b)],s.c]}),e})(),p=(()=>{class e{}return e.\u0275mod=a.Ob({type:e}),e.\u0275inj=a.Nb({factory:function(t){return new(t||e)},imports:[[i.b,o.b,u]]}),e})()}}]);