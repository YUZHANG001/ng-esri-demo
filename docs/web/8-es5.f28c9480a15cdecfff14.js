function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{RXpd:function(e,t,n){"use strict";n.r(t),n.d(t,"SceneEditorModule",(function(){return v}));var r,i,o,a=n("2kYt"),s=n("NcZ/"),c=n("sEIs"),u=n("D57K"),l=n("69HR"),d=n("EM62"),f=n("1i8C"),p=["editorEl"],b=[{path:"",component:(r=function(){function e(t){_classCallCheck(this,e),this.map=t}return _createClass(e,[{key:"ngOnInit",value:function(){this.messageEventHandler=this.receiveMessage.bind(this),addEventListener("message",this.messageEventHandler,!1)}},{key:"ngOnDestroy",value:function(){removeEventListener("message",this.messageEventHandler)}},{key:"loadWebSceneToEditor",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.map.loadWebSceneProperties();case 2:t=e.sent,this.editorEl.nativeElement.contentWindow.postMessage({language:"json",value:JSON.stringify(t,null,"  ")},"*");case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateWebScene",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.map.loadWebSceneProperties();case 2:t=e.sent,this.map.sceneView.subscribe((function(e){t.initialViewProperties.viewingMode=e.viewingMode,t.initialViewProperties.viewpoint=e.viewpoint,n.loadWebSceneToEditor()}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateSceneView",value:function(){this.editorEl.nativeElement.contentWindow.postMessage("getValue","*")}},{key:"cloneWebScene",value:function(){var e=JSON.stringify(this.webscene);return JSON.parse(e)}},{key:"receiveMessage",value:function(e){var t=this;this.editorEl.nativeElement.src.startsWith(e.origin)&&this.map.sceneView.subscribe((function(n){return Object(u.a)(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=JSON.parse(e.data),this.webscene=r,i=this.cloneWebScene(),t.next=6,l.e(i);case 6:o=t.sent,n.map=o,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),alert("\u914d\u7f6e\u9519\u8bef\uff01"),console.error(t.t0);case 13:case"end":return t.stop()}}),t,this,[[0,10]])})))}))}}]),e}(),r.\u0275fac=function(e){return new(e||r)(d.Qb(f.a))},r.\u0275cmp=d.Kb({type:r,selectors:[["app-scene-editor-home"]],viewQuery:function(e,t){var n;1&e&&d.yc(p,!0),2&e&&d.sc(n=d.ic())&&(t.editorEl=n.first)},decls:12,vars:0,consts:[["href","https://developers.arcgis.com/javascript/latest/api-reference/","target","_blank",1,"m-1","text-muted"],[1,"fas","fa-info-circle"],["src","https://beginor.github.io/monaco-editor/index.html",1,"code-editor","border","border-secondary","m-1",3,"load"],["editorEl",""],[1,"tools","btn-group","btn-group-sm","m-1"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fa","fa-fw","fa-angle-double-left"],[1,"fa","fa-fw","fa-angle-double-right"]],template:function(e,t){1&e&&(d.Vb(0,"a",0),d.Rb(1,"i",1),d.Cc(2," ArcGIS JS API Reference"),d.Ub(),d.Vb(3,"iframe",2,3),d.hc("load",(function(){return t.loadWebSceneToEditor()})),d.Ub(),d.Vb(5,"div",4),d.Vb(6,"button",5),d.hc("click",(function(){return t.updateWebScene()})),d.Rb(7,"i",6),d.Cc(8," \u66f4\u65b0\u914d\u7f6e "),d.Ub(),d.Vb(9,"button",5),d.hc("click",(function(){return t.updateSceneView()})),d.Rb(10,"i",7),d.Cc(11," \u66f4\u65b0\u5730\u56fe "),d.Ub(),d.Ub())},styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .code-editor[_ngcontent-%COMP%]{flex:1}"]}),r)}],h=((o=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:o}),o.\u0275inj=d.Nb({factory:function(e){return new(e||o)},imports:[[c.c.forChild(b)],c.c]}),o),v=((i=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:i}),i.\u0275inj=d.Nb({factory:function(e){return new(e||i)},imports:[[a.b,s.b,h]]}),i)}}]);